---
layout: post
title:  "2017-2018 건강검진 당뇨병 예측[데이터 탐구]"
categories: ML
date:   2021-03-10 13:10:18 +0900
tags: 전처리
mathjax: True
author: Haribo
---
* content
{:toc}
데이터 훑어보는 단계라 매우 양이많고 지저분하다.

## 데이터 사이즈

```python
# data analysis and wrangling
import pandas as pd
import numpy as np
import random as rnd

# visualization
import seaborn as sns
import matplotlib.pyplot as plt
%matplotlib inline
```

```python
data_2017 = pd.read_csv('./NHIS_2017_2018_100m/NHIS_OPEN_GJ_2017_100.csv')
data_2018 = pd.read_csv('./NHIS_2017_2018_100m/NHIS_OPEN_GJ_2018_100.csv')
df = pd.concat([data_2017,data_2018])
df.shape
```

```
(2000000, 34)
```

> NHIS_OPEN_GJ_2017_100
>
> * 1000000 x 34
>
> NHIS_OPEN_GJ_2018_100
>
> * 1000000 x 34









## drop할 cols

* HCHK_YEAR : 기준년도
* IDV_ID : 가입자 일련번호
* TTH_MSS_YN : 결손치에관한 데이터지만 전부 Null값이므로 drop
* ODT_TRB_YN : 치아마모증에 관한 데이터지만 전부 Null값이므로 drop
* WSDM_DIS_YN : 사랑니 유무에 관한 데이터지만 전부 Null 값이므로 drop
* DATA_STD__DT : 데이터 작성 기준일자

```python
drop_cols = ['HCHK_YEAR', 'IDV_ID', 'TTH_MSS_YN', 'ODT_TRB_YN', 'WSDM_DIS_YN', 'DATA_STD__DT']
df.drop(drop_cols, axis = 1, inplace = True)
```

## Attributes

### SEX

> * 결측치 0
> * 남자(1) : 1066010
> * 여자(0) : 933990

```python
df['SEX'].value_counts()
df['SEX'].replace({2:0}, inplace=True)
```

```python
df['SEX'].value_counts()
```

```
1    1066010
0     933990
Name: SEX, dtype: int64
```

```python
plt.figure(figsize=(15,10))
sns.countplot(df['SEX'])
plt.title("SEX",fontsize=15)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/sex.png')
plt.show()
```

![](/images/pbl/sex.png)

---

### AGE_GROUP

> * 결측치 0
> * 정규분포를 따름

```python
df['AGE_GROUP'].describe()
```

```
count    2.000000e+06
mean     1.056190e+01
std      2.860501e+00
min      5.000000e+00
25%      8.000000e+00
50%      1.100000e+01
75%      1.300000e+01
max      1.800000e+01
Name: AGE_GROUP, dtype: float64
```

```python
plt.figure(figsize=(15,10))
plt.title("Age",fontsize=15)
sns.countplot(df['AGE_GROUP'])
plt.show()
```

![](/images/pbl/age.png)

### SIDO(시,도 코드)

> * 결측치 0
> * 도시 개수 : 17개

```python
df['SIDO'].value_counts()
```

```
41    498591
11    358397
26    136993
48    133780
28    116227
47    107863
27     94098
44     84789
46     74405
45     72411
43     67788
42     60469
30     59215
29     55408
31     49574
50     20881
36      9111
Name: SIDO, dtype: int64
```

> 17개의 도시코드를 `dummy_variable`로 바꿔준다.

```python
mapper = {11 : 'seoul',
          26 : 'busan',
          27 : 'dagu',
          28 : 'incheon',
          29 : 'kwangju',
          30 : 'dajeon',
          31 : 'ulsan',
          36 : 'sejong',
          41 : 'gyeonggi',
          42 : 'gangwon',
          43 : 'chongB',
          44 : 'chongN',
          45 : 'jeonB',
          46 : 'jeonN',
          47 : 'gyeongB',
          48 : 'gyeongN',
          49 : 'jeju'}
df['SIDO'].replace(mapper, inplace=True)
df['SIDO'] = df['SIDO'].astype('category')
df = pd.get_dummies(df)
```

```python
df.shape
```

```
(2000000, 44)
```

> 19개의 도시 `one-hot-encoding`
>
> * `(2000000, 26)` ->`(2000000, 44)` 

### HEIGHT

> * 결측치 0

```python
df['HEIGHT'].describe()
```

```
count    2.000000e+06
mean     1.622604e+02
std      9.310089e+00
min      1.250000e+02
25%      1.550000e+02
50%      1.600000e+02
75%      1.700000e+02
max      1.900000e+02
Name: HEIGHT, dtype: float64
```

```python
g = sns.FacetGrid(df, col='SEX', height=6, aspect=.65)
g.map_dataframe(sns.histplot, 'HEIGHT', bins=10)
```

![](/images/pbl/height.png)

남여키 모두 정규분포를 따른다

### WEIGHT

> * 결측치 0

```python
df['WEIGHT'].describe()
```

```
count    2.000000e+06
mean     1.622604e+02
std      9.310089e+00
min      1.250000e+02
25%      1.550000e+02
50%      1.600000e+02
75%      1.700000e+02
max      1.900000e+02
Name: HEIGHT, dtype: float64
```

```python
g = sns.FacetGrid(df, col='SEX', height=6, aspect=.65)
g.map_dataframe(sns.histplot, 'WEIGHT', bins=10)
```

![](/images/pbl/weight.png)

남여 몸무게 모두 왼쪽으로 살짝 치우쳐진 정규분포를 따른다

### WAIST(허리둘레)

> * 결측치 680 + 잘못기입 70명

```python
sum(df['WAIST'].isnull())
```

```
680
```

결측치를 제외한 허리둘레 데이터들을 가져온다. 

```python
df_copy = df[df['WAIST'].notnull()].copy()
```

```python
print("The average person waist for {:.1f}cm, 99% of people is {}cm or less, while the biggest waist {}cm.".format(df_copy['WAIST'].mean(), df_copy['WAIST'].quantile(0.99), df_copy['WAIST'].max()))
```

```
The average person waist for 81.3cm, 99% of people is 105.0cm or less, while the biggest waist 999.0cm.
```

밥오밥나무가 건강검진을 받으러 왔나보다. 자세히 알아보자

```python
df_copy[df_copy['WAIST'] > 131]['WAIST'].value_counts()
```

```
999.0    70
135.0     5
134.0     4
132.0     3
136.0     3
133.0     2
140.0     2
136.8     1
133.2     1
132.6     1
149.1     1
131.5     1
139.0     1
138.0     1
145.0     1
Name: WAIST, dtype: int64
```

아무래도 70명은 기입을 잘못한 허리둘레인듯하다.

---

### SIGHT(좌/우 시력에관한 데이터)

나무위키 검색결과 

> 예를 들어 급성 당뇨가 발병하면 시신경과 망막에 손상이 일어나고 혈액 순환이 제대로 되지 않아서 시력이 1.0에서 0.4~4까지 급격히 떨어질수도 있다. 안경으로 어느 정도 교정이 되지만, 문제가 굴절 이상이 아니기 때문에 점점 더 나빠진다. 다행히도 고혈압, 당뇨를 치료하거나 약물로 정상 혈당치와 혈압으로 돌려 놓으면 상당 부분 회복이 되기는 한다

시력또한 당뇨와 관련있는 중요한 데이터라는 사실을 알 수 있었다.

---

> 왼쪽눈 결측치 : 436, 오른쪽눈 결측치 : 455
>
> 공통 결측치 : 485
>
> 잘못기입 : 11625
>
> 

```python
print(sum(df['SIGHT_LEFT'].isnull()), sum(df['SIGHT_RIGHT'].isnull()))
df[(df['SIGHT_LEFT'].isnull()) | (df['SIGHT_RIGHT'].isnull())].shape
```

```
436 455
(485, 44)
```

---

분위수를 출력해보니 시력이 9.9인 사람이있다. 또 잘못기입한듯하다.

```python
df_copy = df[(df['SIGHT_LEFT'].notnull()) & (df['SIGHT_RIGHT'].notnull())]
```

```python
print("The average person sight for {:.1f}, 99% of people is {} or less, while the best sight {}.".format(df_copy['SIGHT_LEFT'].mean(), df_copy['SIGHT_LEFT'].quantile(0.99), df_copy['SIGHT_LEFT'].max()))
print("The average person sight for {:.1f}, 99% of people is {} or less, while the best sight {}.".format(df_copy['SIGHT_RIGHT'].mean(), df_copy['SIGHT_RIGHT'].quantile(0.99), df_copy['SIGHT_RIGHT'].max()))
```

```
The average person sight for 1.0, 99% of people is 2.0 or less, while the best sight 9.9.
The average person sight for 1.0, 99% of people is 2.0 or less, while the best sight 9.9.
```

> 11634 명이 잘못기입됨
>
> 총 12110개의 결측치, 날려도될듯하다

```python
print(df_copy[df_copy['SIGHT_LEFT'] > 2.5]['SIGHT_LEFT'].value_counts())
print(df_copy[df_copy['SIGHT_RIGHT'] > 2.5]['SIGHT_RIGHT'].value_counts())
```

```
9.9    6337
Name: SIGHT_LEFT, dtype: int64
9.9    6284
Name: SIGHT_RIGHT, dtype: int64
```

```python
df[(df['SIGHT_LEFT'] > 2.5) | (df['SIGHT_RIGHT'] > 2.5)].shape
```

```
(11635, 44)
```

![left](/images/pbl/sight_left.png)

![left](/images/pbl/sight_right.png)

---

### HEAR(좌/우 청력에관한 데이터)

> [청력감퇴와 당뇨사이의 관계](https://danapump.tistory.com/163)
>
> * 잘들림 : 1
> * 잘안들림 : 0

```python
df['HEAR_LEFT'].replace({2 : 0}, inplace=True)
df['HEAR_RIGHT'].replace({2 : 0}, inplace=True)
print(df['HEAR_LEFT'].value_counts())
print(df['HEAR_RIGHT'].value_counts())
```

```
1.0    1934242
0.0      65383
Name: HEAR_LEFT, dtype: int64
1.0    1936603
0.0      63024
Name: HEAR_RIGHT, dtype: int64
```



---

> 왼쪽귀 결측치 : 375, 오른쪽귀 결측치 : 373
>
> 공통 결측치 : 385
>
> 결측치 수가 적어서 데이터 날려도될듯하다.

```python
print(sum(df['HEAR_LEFT'].isnull()), sum(df['HEAR_RIGHT'].isnull()))
df[(df['HEAR_LEFT'].isnull()) | (df['HEAR_RIGHT'].isnull())].shape
```

```
375 373
(385, 44)
```

![left](/images/pbl/HEAR_LEFT.png)

![left](/images/pbl/HEAR_RIGHT.png)

---

### 총 외부스펙 결측치 + outlier

> * 허리둘레 결측치
> * 허리둘레 outlier
> * 시력 좌/우 결측치
> * 시력 좌/우 outlier
> * 청력 좌/우 결측치
>
> 12702개의 데이터

```python
waist_null = df['WAIST'].isnull()
waist_outlier = df['WAIST'] > 300
sight_LR_null = (df['SIGHT_LEFT'].isnull()) | (df['SIGHT_RIGHT'].isnull())
sight_LR_outlier = (df['SIGHT_LEFT']>2.5) | (df['SIGHT_RIGHT']>2.5)
hear_LR_null = sight_LR_null = (df['HEAR_LEFT'].isnull()) | (df['HEAR_RIGHT'].isnull())
df[waist_null | waist_outlier | sight_LR_null | sight_LR_outlier | hear_LR_null]
```

```
12702 rows × 44 columns
```

### BP(혈압)

```python
print(df['BP_HIGH'].isnull().sum())
print(df['BP_LWST'].isnull().sum())
print(df[df['BP_HIGH'].isnull() | df['BP_LWST'].isnull()].isnull().shape)
```

```
5749
5748
(5750, 44)
```

> 수축기 혈압 결측치 : 5749
> 이온기 혈압 결측치 : 5748
> 혈압 총 결측치 : 5750

```python
df_copy = df[df['BP_HIGH'].notnull() | df['BP_LWST'].notnull()].copy()
print("The average person BP_HIGH for {:.1f}, 99% of people is {} or less, 1% of people is {} or more, while the max BP_HIGH {}, min BP_HIGH {}.".format(df_copy['BP_HIGH'].mean(), df_copy['BP_HIGH'].quantile(0.99), df_copy['BP_HIGH'].quantile(0.01), df_copy['BP_HIGH'].max(), df_copy['BP_HIGH'].min()))
print("The average person BP_LWST for {:.1f}, 99% of people is {} or less, 1% of people is {} or more, while the max BP_LWST {}, min BP_LWST {}.".format(df_copy['BP_LWST'].mean(), df_copy['BP_LWST'].quantile(0.99), df_copy['BP_LWST'].quantile(0.01), df_copy['BP_LWST'].max(), df_copy['BP_LWST'].min()))
```

```
The average person BP_HIGH for 122.5, 99% of people is 162.0 or less, 1% of people is 91.0 or more, while the max BP_HIGH 273.0, min BP_HIGH 58.0.
The average person BP_LWST for 76.1, 99% of people is 102.0 or less, 1% of people is 56.0 or more, while the max BP_LWST 185.0, min BP_LWST 27.0.
```

분위수 출력하니 이상치가 꽤있나. 잘못된 기입인지 한번 시각화 해보았다.

```python
data = df_copy.copy()
data.loc[data['BP_HIGH'] > data['BP_HIGH'].quantile(0.99)] = '163+'
plt.figure(figsize=(30,10))
sns.countplot(data['BP_HIGH'].astype('str').sort_values())
plt.title("BP_HIGH",fontsize=15)
plt.show()
```

![](/images/pbl/BP_HIGH.png)

---

```python
data = df_copy.copy()
data.loc[data['BP_LWST'] > data['BP_LWST'].quantile(0.99)] = '103+'
plt.figure(figsize=(30,10))
sns.countplot(data['BP_LWST'].astype('str').sort_values())
plt.title("BP_LWST",fontsize=15)
plt.show()
```

![](/images/pbl/BP_LWST.png)

잘못된 기입은 아닌것같다. 

### BLDS(Target)

> 2형당뇨 진단기준
>
> * `if BLDS > 126 : True`
>
> 하지만 심각한 불균형 데이터
>
> 127 이상 `BLDS` : 143873
>
> 127 미만 `BLDS` : 1850170
>
> * 거의 13 : 1 비율

```python
df['BLDS'].isnull().sum()
```

```
5957
```

> 결측치 5957

```python
df_copy = df[df['BLDS'].notnull()]
df_copy['BLDS'].describe()
```

```
count    1.994043e+06
mean     1.006600e+02
std      2.418251e+01
min      2.300000e+01
25%      8.900000e+01
50%      9.600000e+01
75%      1.050000e+02
max      8.720000e+02
Name: BLDS, dtype: float64
```

```python
print("The average person BLDS for {:.1f}, 99% of people is {} or less, while the max BLDS {}.".format(df_copy['BLDS'].mean(), df_copy['BLDS'].quantile(0.99), df_copy['BLDS'].max()))
```

```
The average person BLDS for 100.7, 99% of people is 204.0 or less, while the max BLDS 872.0.
```

> 2형 당뇨기준 127이상이되면 당뇨병 진단을 내리지만 당뇨병 환자의 경우 정상 `BLDS`의 8배까지 올라갈 수 있다.
>
> 즉 `outlier`는 이미 당뇨병 환자라는 것이다.

```python
data = df_copy.copy()
plt.figure(figsize=(15,10))
plt.title("BLDS[TARGET]",fontsize=15)
sns.distplot(data['BLDS'])
plt.show()
```

![](/images/pbl/BLDS.png)

> 1 : 당뇨
>
> 0: 정상

```python
df.loc[ df['BLDS'] < 127, 'BLDS'] = 0
df.loc[ df['BLDS'] >= 127, 'BLDS'] = 1
```

```python
plt.figure(figsize=(15,10))
sns.countplot(df['BLDS'])
plt.title("BLDS",fontsize=15)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/BLDS_01.png')
plt.show()
```

![](/images/pbl/BLDS_01.png)

### CHOLE(콜레스테롤 수치)

> `TOT_CHOLE = TRIGLYCERIDE/5 + HDL_CHOLE + LDL_CHOLE`
>
> 4개 콜레스테롤 수치 결측치합 : 677043

```python
tot_null = df['TOT_CHOLE'].isnull()
tri_null = df['TRIGLYCERIDE'].isnull()
hdl_null = df['HDL_CHOLE'].isnull()
ldl_null = df['LDL_CHOLE'].isnull()
print(tot_null.sum(), tri_null.sum(), hdl_null.sum(), ldl_null.sum())
```

```
667287 667297 667298 677034
```

```python
df[tot_null | tri_null | hdl_null | ldl_null].shape
```

```
(677043, 44)
```

> 콜레스트롤 수치는 원심분리기를 이용한 측정이기 때문에, 추정할 수 없으므로 삭제처리한다.

```python
print("The average person TOT_CHOLE for {:.1f}, 99% of people is {} or less, while the max TOT_CHOLE {}.".format(df['TOT_CHOLE'].mean(), df['TOT_CHOLE'].quantile(0.99), df['TOT_CHOLE'].max()))
print("The average person TRIGLYCERIDE for {:.1f}, 99% of people is {} or less, while the max TRIGLYCERIDE {}.".format(df['TRIGLYCERIDE'].mean(), df['TRIGLYCERIDE'].quantile(0.99), df['TRIGLYCERIDE'].max()))
print("The average person HDL_CHOLE for {:.1f}, 99% of people is {} or less, while the max HDL_CHOLE {}.".format(df['HDL_CHOLE'].mean(), df['HDL_CHOLE'].quantile(0.99), df['HDL_CHOLE'].max()))
print("The average person LDL_CHOLE for {:.1f}, 99% of people is {} or less, while the max LDL_CHOLE {}.".format(df['LDL_CHOLE'].mean(), df['LDL_CHOLE'].quantile(0.99), df['LDL_CHOLE'].max()))
```

```
The average person TOT_CHOLE for 195.6, 99% of people is 296.0 or less, while the max TOT_CHOLE 2386.0.
The average person TRIGLYCERIDE for 133.5, 99% of people is 508.0 or less, while the max TRIGLYCERIDE 9490.0.
The average person HDL_CHOLE for 56.8, 99% of people is 99.0 or less, while the max HDL_CHOLE 8110.0.
The average person LDL_CHOLE for 113.1, 99% of people is 203.0 or less, while the max LDL_CHOLE 5119.0.
```

꽤나 높은 이상치들이 보인다.

**BLDS / 총 콜레스트롤**

```python
plt.figure(figsize=(15,10))
sns.displot(data=df, x = 'TOT_CHOLE', col = 'BLDS', kde=True)
plt.show()
```

![](/images/pbl/TOT_CHOLE.png)

---

**BLDS / 트라이글리세린**

```python
plt.figure(figsize=(15,10))
sns.displot(data=df, x = 'TRIGLYCERIDE', col = 'BLDS', kde=True)
plt.show()
```

![](/images/pbl/TRIGLYCERIDE.png)

---

**BLDS / HDL 콜레스테롤**

```python
plt.figure(figsize=(15,10))
sns.displot(data=df, x = 'HDL_CHOLE', col = 'BLDS', kde=True)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/HDL_CHOLE.png')
plt.show()
```

![](/images/pbl/HDL_CHOLE.png)

---

**BLDS / LDL 콜레스테롤**

```python
plt.figure(figsize=(15,10))
sns.displot(data=df, x = 'LDL_CHOLE', col = 'BLDS', kde=True)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/LDL_CHOLE.png')
plt.show()
```

![](/images/pbl/LDL_CHOLE.png)

 그래프상으로 당뇨환자와 정상인의 콜레스테롤 수치는 크게 차이나보이지 않는다.

---

> 정상인 콜레스테롤 결측치 : 622706
>
> 당뇨 콜레스테롤 결측치 : 48386
>
> 불균형 데이터였기 때문에 삭제처리를 하는것이 오히려 더 좋을듯 하다.

```python
print('콜레스테롤 결측치 총 개수', df[(tot_null | tri_null | hdl_null | ldl_null)].shape[0])
print('당뇨인 콜레스테롤 결측치 개수',df[(tot_null | tri_null | hdl_null | ldl_null) & (df['BLDS'] == 1)].shape[0])
print('정상인 콜레스테롤 결측치 개수',df[(tot_null | tri_null | hdl_null | ldl_null) & (df['BLDS'] == 0)].shape[0])
```

```
콜레스테롤 결측치 총 개수 677043
당뇨인 콜레스테롤 결측치 개수 48386
정상인 콜레스테롤 결측치 개수 622706
```

### HMG(혈색소)

> 결측치 5966

```python
print("The average person HMG for {:.1f}, 99% of people is {} or less, while the max HMG {}.".format(df['HMG'].mean(), df['HMG'].quantile(0.99), df['HMG'].max()))
```

```
The average person HMG for 14.3, 99% of people is 17.5 or less, while the max HMG 25.0.
```

엄청큰 이상치는 없어보인다

```python
plt.figure(figsize=(15,10))
sns.displot(data=df, x = 'HMG', col = 'BLDS', kde=True)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/HMG.png')
plt.show()
```

![](/images/pbl/HMG.png)

분포도 정상인과의 차이는 크게 보이지 않는다.

### OLIG_PROTE_CD(요단백)

> 결측치 : 15162
>
> 당뇨병의 합병증 중 하나로 중요한 요소가 될것같다.

```python
df['OLIG_PROTE_CD'].value_counts()
```

```
1.0    1869368
2.0      64331
3.0      33603
4.0      12546
5.0       3951
6.0       1039
```

```python
plt.figure(figsize=(15,10))
sns.countplot(df['OLIG_PROTE_CD'])
plt.title("OLIG_PROTE_CD",fontsize=15)
plt.show()
```

![](/images/pbl/OLIG_PROTE_CD.png)

### CREATININE

> [혈청](https://ko.wikipedia.org/wiki/혈청) 크레아티닌(혈액 측정)은 [콩팥](https://ko.wikipedia.org/wiki/콩팥)에 의해 변하지 않고 배설되는 근육 대사의 부산물로 쉽게 측정되므로 콩팥 건강의 중요한 지표이다
>
> 결측치 : 5949

```python
print("The average person CREATININE for {:.1f}, 99% of people is {} or less, while the max CREATININE {}.".format(df['CREATININE'].mean(), df['CREATININE'].quantile(0.99), df['CREATININE'].max()))
```

```
The average person CREATININE for 0.9, 99% of people is 1.4 or less, while the max CREATININE 98.0.
```

상당히 큰 이상치가 존재한다. `value_counts` 로 봤을 때 잘못기입된 값은 아닌것 같다.

```python
#replace any no of kills greater than 0.99 of data with 8 kills for better visuals
temp= df.copy()
temp.loc[temp['CREATININE'] > temp['CREATININE'].quantile(0.99)] = '1.5+'
plt.figure(figsize=(15,10))
sns.countplot(temp['CREATININE'].astype('str').sort_values())
plt.title('CREATININE')
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/CREATININE.png')
plt.show()
```

![](/images/pbl/CREATININE.png)

### SGOT_AST

> 결측치 : 5949

```python
df['SGOT_AST'].isnull().sum()
```

```
5947
```

```python
print("The average person SGOT_AST for {:.1f}, 99% of people is {} or less, while the max SGOT_AST {}.".format(df['SGOT_AST'].mean(), df['SGOT_AST'].quantile(0.99), df['SGOT_AST'].max()))
```

```
The average person SGOT_AST for 26.1, 99% of people is 81.0 or less, while the max SGOT_AST 9999.0.
```

상당한 크기의 이상치가 존재한다. `value_counts`로 확인해본 결과 이상치는 아닌것으로 판단됨

```python
df[df['SGOT_AST'] > 5000]['SGOT_AST'].value_counts()
```

```
7000.0    2
9999.0    2
5952.0    1
6680.0    1
7931.0    1
5757.0    1
Name: SGOT_AST, dtype: int64
```

```python
#replace any no of kills greater than 0.99 of data with 8 kills for better visuals
col = 'SGOT_AST'
temp= df.copy()
temp.loc[temp[col] > temp[col].quantile(0.99)] = '82+'
plt.figure(figsize=(15,10))
sns.countplot(temp[col].astype('str').sort_values())
plt.title(col)
plt.show()
```

![](/images/pbl/SGOT_AST.png)

### SGPT_ALT

### 

> 결측치 : 5948

```python
df['SGPT_ALT'].isnull().sum()
```

```
5948
```

```python
print("The average person SGPT_ALT for {:.1f}, 99% of people is {} or less, while the max SGPT_ALT {}.".format(df['SGPT_ALT'].mean(), df['SGPT_ALT'].quantile(0.99), df['SGPT_ALT'].max()))
```

```
The average person SGPT_ALT for 26.0, 99% of people is 107.0 or less, while the max SGPT_ALT 7210.0.
```

상당한 크기의 이상치가 존재한다. `value_counts`로 확인해본 결과 이상치는 아닌것으로 판단됨

```python
df[df['SGPT_ALT'] > 3000]['SGPT_ALT'].value_counts()
```

```
3150.0    1
3160.0    1
3720.0    1
3832.0    1
3975.0    1
3560.0    1
5896.0    1
4633.0    1
3807.0    1
3307.0    1
7210.0    1
3517.0    1
Name: SGPT_ALT, dtype: int64
```

```python
#replace any no of kills greater than 0.99 of data with 8 kills for better visuals
col = 'SGPT_ALT'
temp= df.copy()
temp.loc[temp[col] > temp[col].quantile(0.99)] = '108+'
plt.figure(figsize=(15,10))
sns.countplot(temp[col].astype('str').sort_values())
plt.title(col)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/{}.png'.format(col))
plt.show()
```

![](/images/pbl/SGPT_ALT.png)

분포그래프 초반부와 후반부에 이상치로 보이는 값들이 몇 존재함

### GAMMA_GTP

> 남성 정상치 : 11~63IU/L
>
> 여성 정상치 : 8~35IU/L
>
> 결측치 : 5951

```python
df['GAMMA_GTP'].isnull().sum()
```

```
5951
```

```python
# 남여 분리
man_df = df[df['SEX'] == 1]
woman_df = df[df['SEX'] == 0]
```

```python
print("The average person man GAMMA_GTP for {:.1f}, 99% of people is {} or less, while the max man GAMMA_GTP {}.".format(man_df['GAMMA_GTP'].mean(), man_df['GAMMA_GTP'].quantile(0.99), man_df['GAMMA_GTP'].max()))
print("The average person woman GAMMA_GTP for {:.1f}, 99% of people is {} or less, while the max woman GAMMA_GTP {}.".format(woman_df['GAMMA_GTP'].mean(), woman_df['GAMMA_GTP'].quantile(0.99), woman_df['GAMMA_GTP'].max()))
```

```
The average person man GAMMA_GTP for 49.6, 99% of people is 295.0 or less, while the max man GAMMA_GTP 999.0.
The average person woman GAMMA_GTP for 23.5, 99% of people is 123.0 or less, while the max woman GAMMA_GTP 999.0.
```

상당히 큰 이상치가 있으므로 확인해본다.

```python
print(man_df[man_df['GAMMA_GTP'] > 980]['GAMMA_GTP'].value_counts())
print('='*20)
print(woman_df[woman_df['GAMMA_GTP'] > 980]['GAMMA_GTP'].value_counts())
```

```

999.0    432
993.0      5
982.0      4
996.0      4
990.0      3
989.0      3
998.0      3
984.0      3
992.0      3
997.0      2
994.0      2
991.0      1
986.0      1
983.0      1
987.0      1
988.0      1
Name: GAMMA_GTP, dtype: int64
====================
999.0    69
990.0     2
993.0     2
998.0     2
995.0     1
994.0     1
989.0     1
Name: GAMMA_GTP, dtype: int64
```

`999` 수치는 아무래도 잘못기입한 값으로 판단된다.

---

```
#replace any no of kills greater than 0.99 of data with 8 kills for better visuals
col = 'GAMMA_GTP'
temp= man_df.copy()
temp.loc[temp[col] > temp[col].quantile(0.99)] = '296+'
plt.figure(figsize=(15,10))
sns.countplot(temp[col].astype('str').sort_values())
plt.title(col)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/man_GAMMA_GTP.png')
plt.show()
```

![](/images/pbl/man_GAMMA_GTP.png)

남성 감마 지피티 그래프인데 상당히 안좋은 형태의 분포도가 나왔다.  잘못기입된 값이 생각보다 많다

---

```
#replace any no of kills greater than 0.99 of data with 8 kills for better visuals
col = 'GAMMA_GTP'
temp= woman_df.copy()
temp.loc[temp[col] > temp[col].quantile(0.99)] = '124+'
plt.figure(figsize=(15,10))
sns.countplot(temp[col].astype('str').sort_values())
plt.title(col)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/woman_GAMMA_GTP.png')
plt.show()
```

![](/images/pbl/woman_GAMMA_GTP.png)

여성 감마 지피티 그래프

> 구간별로 나눠서 카테고리화를 해주어야 할듯하다.
>
> * 아무래도 반올림 하고안하고의 문제 인듯함



### SMK_STAT_TYPE_CD

> 흡연 여부
>
> * 1 : 안핌
> * 2 : 끊음
> * 3 : 흡연

끊은 사람도 안피는 사람으로 바꿔준다.

> 비흡연자 : 1
>
> 흡연자 : 0

```python
df['SMK_STAT_TYPE_CD'].replace({2:1}, inplace=True)
df['SMK_STAT_TYPE_CD'].replace({3:0}, inplace=True)
```

```python
#replace any no of kills greater than 0.99 of data with 8 kills for better visuals
col = 'SMK_STAT_TYPE_CD'
temp= df[df['SMK_STAT_TYPE_CD'].notnull()].copy()
plt.figure(figsize=(15,10))
sns.countplot(temp[col].astype('str').sort_values())
plt.title(col)
plt.show()
```

![](/images/pbl/SMK_STAT_TYPE_CD.png)

### DRK_YN

> 결측치 : 355479
>
> `DRK_YN` 결측치 중 당뇨병인 사람 : 30319
>
> `DRK_YN` 결측치 중 정상인 사람 : 320501
>
> 불균형을 줄이기 위해 삭제하는게 나을듯 하다.

```python
print(sum(df[df['DRK_YN'].isnull()]['BLDS'] == 1))
print(sum(df[df['DRK_YN'].isnull()]['BLDS'] == 0))
```

```
30319
320501
```



```python
#replace any no of kills greater than 0.99 of data with 8 kills for better visuals
col = 'DRK_YN'
temp= df[df['DRK_YN'].notnull()].copy()
plt.figure(figsize=(15,10))
sns.countplot(temp[col].astype('str').sort_values())
plt.title(col)
plt.savefig('/Users/minsuha/gkalstn000.github.io/images/pbl/DRK_YN.png')
plt.show()
```

![](/images/pbl/DRK_YN.png)

## 치아관련 columns

너무많은 결측치로인해열 삭제처린

### HCHK_OE_INSPEC_YN

### CRS_YN

### TTH_M SS_YN(Droped)

### ODT_TR B_YN(Droped)

### WSDM_ DIS_YN(Droped)

### TTR_YN

### DATA_STD__DT(Droped)